"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[8831],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),m=p(a),d=r,h=m["".concat(l,".").concat(d)]||m[d]||u[d]||i;return a?n.createElement(h,o(o({ref:t},c),{},{components:a})):n.createElement(h,o({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[m]="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},417:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var n=a(7462),r=(a(7294),a(3905));const i={sidebar_position:2},o="Create a store",s={unversionedId:"walkthrough/create-a-store",id:"walkthrough/create-a-store",title:"Create a store",description:"Create a model that represents the data and a store.",source:"@site/docs/walkthrough/create-a-store.md",sourceDirName:"walkthrough",slug:"/walkthrough/create-a-store",permalink:"/object-relationship-store/docs/walkthrough/create-a-store",draft:!1,editUrl:"https://github.com/JoshBot-Debug/object-relationship-store/tree/main/documentation/docs/walkthrough/create-a-store.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"docsSidebar",previous:{title:"Create a project",permalink:"/object-relationship-store/docs/walkthrough/create-a-project"},next:{title:"Create data",permalink:"/object-relationship-store/docs/walkthrough/create-data"}},l={},p=[{value:"Data structure",id:"data-structure",level:2},{value:"Create a model and define relationships",id:"create-a-model-and-define-relationships",level:2},{value:"Create the store",id:"create-the-store",level:2}],c={toc:p},m="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(m,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"create-a-store"},"Create a store"),(0,r.kt)("p",null,"Create a model that represents the data and a store."),(0,r.kt)("h2",{id:"data-structure"},"Data structure"),(0,r.kt)("p",null,"In this example, we are going to use this data structure. It is based on the ",(0,r.kt)("inlineCode",{parentName:"p"},"posts")," data provided in ",(0,r.kt)("a",{parentName:"p",href:"./create-a-project#prepare-some-data"},"this section"),". We will use ",(0,r.kt)("inlineCode",{parentName:"p"},"typescript")," to define the structure of our objects. However, the example project is in ",(0,r.kt)("inlineCode",{parentName:"p"},"vanilla js"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},"\ninterface User {\n  id: number;\n  username: string;\n  profileImage: Image;\n}\n\ninterface Image {\n  id: number;\n  aspectRatio: number;\n  thumbnails: Thumbnail[];\n}\n\ninterface Thumbnail {\n  id: number;\n  uri: string;\n}\n\ninterface Post {\n  id: number;\n  caption: string;\n  createdAt: string;\n  images: Image[];\n  user: User;\n}\n\n")),(0,r.kt)("p",null,"Here is the relationship we can see based on the above structure."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"One ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," has one ",(0,r.kt)("inlineCode",{parentName:"li"},"Image")," as ",(0,r.kt)("inlineCode",{parentName:"li"},"profileImage")),(0,r.kt)("li",{parentName:"ul"},"One ",(0,r.kt)("inlineCode",{parentName:"li"},"Image")," has many ",(0,r.kt)("inlineCode",{parentName:"li"},"Thumbnail")," as ",(0,r.kt)("inlineCode",{parentName:"li"},"thumbnails")),(0,r.kt)("li",{parentName:"ul"},"One ",(0,r.kt)("inlineCode",{parentName:"li"},"Post")," has one ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," as ",(0,r.kt)("inlineCode",{parentName:"li"},"user")),(0,r.kt)("li",{parentName:"ul"},"One ",(0,r.kt)("inlineCode",{parentName:"li"},"Post")," has many ",(0,r.kt)("inlineCode",{parentName:"li"},"Image")," as ",(0,r.kt)("inlineCode",{parentName:"li"},"images"))),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Based on this, it's safe to say that we can possibly have a ",(0,r.kt)("inlineCode",{parentName:"em"},"user.posts"),", where one ",(0,r.kt)("inlineCode",{parentName:"em"},"User")," can have many ",(0,r.kt)("inlineCode",{parentName:"em"},"Post")," objects, probably under the key ",(0,r.kt)("inlineCode",{parentName:"em"},"posts")," (could be anything we want). Remember this, we'll come back to it later.")),(0,r.kt)("h2",{id:"create-a-model-and-define-relationships"},"Create a model and define relationships"),(0,r.kt)("p",null,"Now that we have an idea of what the data we will be upserting into the store looks like, we can start creating the model and define their relationships."),(0,r.kt)("p",null,"To define object and relationships, we need to use ",(0,r.kt)("a",{parentName:"p",href:"../apis/createRelationalObject"},(0,r.kt)("inlineCode",{parentName:"a"},"createRelationalObject()"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example-project/index.js"',title:'"example-project/index.js"'},'import { createRelationalObject } from "@jjmyers/object-relationship-store";\n\nconst user = createRelationalObject("user")\nconst image = createRelationalObject("image")\nconst thumbnail = createRelationalObject("thumbnail")\nconst post = createRelationalObject("post")\n\n// "Post" has one "User" as user\npost.hasOne(user)\n\n// "Post" has many "Image" as images\npost.hasMany(image, "images")\n\n// "User" has one "Image" as profileImage\nuser.hasOne(image, "profileImage")\n\n// "Image" has many "Thumbnail" as thumbnails\nimage.hasMany(thumbnail, "thumbnails")\n\n/**\n * "User" has many "Post" as posts\n * The example JSON data `posts` does not contain a user which has the field posts.\n * However, we can define this relationship.\n */ \nuser.hasMany(post, "posts")\n')),(0,r.kt)("p",null,"So far, we have used ",(0,r.kt)("a",{parentName:"p",href:"../apis/createRelationalObject"},(0,r.kt)("inlineCode",{parentName:"a"},"createRelationalObject()"))," to define our objects and their relationships.",(0,r.kt)("br",{parentName:"p"}),"\n",(0,r.kt)("em",{parentName:"p"},"Note: Even though the data we receive does not contain a ",(0,r.kt)("inlineCode",{parentName:"em"},"User")," object that has a field ",(0,r.kt)("inlineCode",{parentName:"em"},"posts")," that contains many ",(0,r.kt)("inlineCode",{parentName:"em"},"Post")," objects, we have still defined this relationship.")),(0,r.kt)("h2",{id:"create-the-store"},"Create the store"),(0,r.kt)("p",null,"Now we can use ",(0,r.kt)("a",{parentName:"p",href:"../apis/createStore"},(0,r.kt)("inlineCode",{parentName:"a"},"createStore()"))," to create a ",(0,r.kt)("strong",{parentName:"p"},"store")," using the ",(0,r.kt)("strong",{parentName:"p"},"models")," we defined. We will also have to tell the store how to identify an object.",(0,r.kt)("br",{parentName:"p"}),"\n","The store will use these ",(0,r.kt)("a",{parentName:"p",href:"../apis/createStore#identifier"},(0,r.kt)("inlineCode",{parentName:"a"},"identifier"))," functions to identify the type of the object ",(0,r.kt)("strong",{parentName:"p"},"if it is not specified in the object.")," ",(0,r.kt)("em",{parentName:"p"},"(Will be discussed later.)")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example-project/index.js"',title:'"example-project/index.js"'},'import { createStore } from "@jjmyers/object-relationship-store";\n\nconst store = createStore({\n\n  // All the objects defined with createRelationalObject()\n  relationalCreators: [\n    user,\n    image,\n    thumbnail,\n    post,\n  ],\n\n  identifier: {\n    // If the field "username" is in the object, this is a "User" object.\n    user: o => "username" in o,\n    post: o => "caption" in o,\n    image: o => "aspectRatio" in o,\n    thumbnail: o => "uri" in o,\n  }\n});\n')))}u.isMDXComponent=!0}}]);